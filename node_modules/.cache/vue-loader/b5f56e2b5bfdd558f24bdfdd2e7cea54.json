{"remainingRequest":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\src\\views\\home\\equipment.vue?vue&type=style&index=0&id=7b99ec10&scoped=true&lang=scss","dependencies":[{"path":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\src\\views\\home\\equipment.vue","mtime":1688834276471},{"path":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICIuL2Nzcy9lcXVpcG1lbnQuc2NzcyI7DQo="},{"version":3,"sources":["C:\\Users\\DELL\\Desktop\\code\\dt_cup_innovate_ui\\src\\views\\home\\equipment.vue"],"names":[],"mappings":";AA8jBA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC","file":"C:/Users/DELL/Desktop/code/dt_cup_innovate_ui/src/views/home/equipment.vue","sourceRoot":"","sourcesContent":["<template>\r\n\t<div class=\"content-box\">\r\n\t\t<el-dialog v-model=\"dialog_Visible\" :title=\"title\" width=\"75%\">\r\n\t\t\t<div style=\"display: flex\">\r\n\t\t\t\t<el-tree style=\"width: 2.8rem;\" :data=\"data\" node-key=\"id\" ref=\"tree\" default-expand-all\r\n\t\t\t\t\t:check-strictly=\"true\" :expand-on-click-node=\"false\" :props=\"defaultProps\"\r\n\t\t\t\t\t:default-checked-keys=\"monitorFactor\" @current-change=\"handleCheckChange\" @check=\"handleCheck\">\r\n\t\t\t\t\t<template #default=\"{ node, data }\">\r\n\t\t\t\t\t\t<!-- 编辑状态 -->\r\n\t\t\t\t\t\t<template v-if=\"node.isEdit\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"data.name\" autofocus size=\"mini\" :ref=\"'slotTreeInput' + data.id\"\r\n\t\t\t\t\t\t\t\t@blur.stop=\"handleInput(node, data)\" @keyup.enter.native=\"handleInput(node, data)\">\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t<!-- 非编辑状态 -->\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span class=\"custom-tree-node\">\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t:class=\"(data.id == sole_id && data.id != undefined && table_show == true) ? 'activetext' : ''\"\r\n\t\t\t\t\t\t\t\t\t@click=\"CheckTitle(data, node)\">{{\r\n\t\t\t\t\t\t\t\t\t\tdata.name\r\n\t\t\t\t\t\t\t\t\t}} <span v-if=\"data.id\">-</span> {{ data.serial_number }}</span>\r\n\t\t\t\t\t\t\t\t<span v-if=\"data.type != 'Entries'\">\r\n\t\t\t\t\t\t\t\t\t<el-button v-if=\"data.parent_id == ''\" type=\"text\" size=\"mini\" @click=\"append(data)\"> 增加\r\n\t\t\t\t\t\t\t\t\t</el-button>\r\n\r\n\t\t\t\t\t\t\t\t\t<el-button type=\"text\" size=\"mini\" style=\"margin-left: 8px\" @click=\"remove(node, data)\">\r\n\t\t\t\t\t\t\t\t\t\t删除\r\n\t\t\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t\t\t\t<el-button type=\"text\" size=\"mini\" @click=\"handleEdit(node, data)\"> 修改 </el-button>\r\n\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-tree>\r\n\t\t\t\t<div class=\"c-right\" style=\"flex: 1; overflow: hidden\">\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t<li v-for=\"(item, index) in tree_structure\" :key=\"index\" v-show=\"table_show\">\r\n\t\t\t\t\t\t\t<el-table border :data=\"dataSource\" style=\"width: 95%\" min-width=\"3\"\r\n\t\t\t\t\t\t\t\t:header-cell-style=\"{ background: '#eee' }\">\r\n\t\t\t\t\t\t\t\t<el-table-column ref=\"tab\" width='300px' min-width='300px'\r\n\t\t\t\t\t\t\t\t\tv-for=\"(item, index) in columnData\" :key=\"index\" :prop=\"item.prop\" :label=\"item.label\"\r\n\t\t\t\t\t\t\t\t\t:render-header=\"renderHeader\">\r\n\t\t\t\t\t\t\t\t\t<template #default=\"scope\">\r\n\t\t\t\t\t\t\t\t\t\t<span v-if=\"item.label == '序号'\">\r\n\t\t\t\t\t\t\t\t\t\t\t<el-input v-model=\"scope.row[item.prop]\" :disabled=\"true\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"\"></el-input>\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t<span v-else>\r\n\t\t\t\t\t\t\t\t\t\t\t<el-input v-model=\"scope.row[item.prop]\" placeholder=\"请输入内容\"></el-input>\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t</el-table-column>\r\n\t\t\t\t\t\t\t</el-table>\r\n\t\t\t\t\t\t\t<div style=\"margin-top: 10px\">\r\n\t\t\t\t\t\t\t\t<el-button @click=\"AddRow()\" v-show=\"Hide\">\r\n\t\t\t\t\t\t\t\t\t<el-icon style=\"vertical-align: middle\">\r\n\t\t\t\t\t\t\t\t\t\t<CirclePlus />\r\n\t\t\t\t\t\t\t\t\t</el-icon>\r\n\t\t\t\t\t\t\t\t\t<span style=\"vertical-align: middle\"> 增加行 </span>\r\n\t\t\t\t\t\t\t\t</el-button>\r\n\r\n\t\t\t\t\t\t\t\t<el-button @click=\"RemoveRow()\" v-show=\"Hide\">\r\n\t\t\t\t\t\t\t\t\t<el-icon style=\"vertical-align: middle\">\r\n\t\t\t\t\t\t\t\t\t\t<Remove />\r\n\t\t\t\t\t\t\t\t\t</el-icon>\r\n\t\t\t\t\t\t\t\t\t<span style=\"vertical-align: middle\"> 删除行 </span>\r\n\t\t\t\t\t\t\t\t</el-button>\r\n\r\n\t\t\t\t\t\t\t\t<el-button @click=\"addColumn()\">\r\n\t\t\t\t\t\t\t\t\t<el-icon style=\"vertical-align: middle\">\r\n\t\t\t\t\t\t\t\t\t\t<CirclePlus />\r\n\t\t\t\t\t\t\t\t\t</el-icon>\r\n\t\t\t\t\t\t\t\t\t<span style=\"vertical-align: middle\"> 增加列 </span>\r\n\t\t\t\t\t\t\t\t</el-button>\r\n\r\n\t\t\t\t\t\t\t\t<el-button @click=\"RemoveColumn()\">\r\n\t\t\t\t\t\t\t\t\t<el-icon style=\"vertical-align: middle\">\r\n\t\t\t\t\t\t\t\t\t\t<Remove />\r\n\t\t\t\t\t\t\t\t\t</el-icon>\r\n\t\t\t\t\t\t\t\t\t<span style=\"vertical-align: middle\"> 删除列 </span>\r\n\t\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"save-box\">\r\n\t\t\t\t<el-button type=\"primary\" @click=\"saveData()\">\r\n\t\t\t\t\t<span style=\"vertical-align: middle\"> 保存 </span>\r\n\t\t\t\t</el-button>\r\n\t\t\t</div>\r\n\t\t</el-dialog>\r\n\t\t<!-- 中信科logo -->\r\n\t\t\t<img class=\"logo\" @click=\"logo\" src=\"./img/logo_2.png\" alt=\"\">\r\n\t\t<!-- 小唐人弹出框开始 -->\r\n\t\t<div class=\"logoBox\" v-show=\"dialog_show\">\r\n\t\t\t<span>\r\n\t\t\t\t针对选中的创新应用场景，在界面左侧，根据设计需要，进行相应基站和终端类型的选择，通过拖拽到界面中间的地图，进行创新应用的部署。在界面右侧的4个功能键，可以一次点击相应的功能按键，分别对基站配置、终端配置、硬件开发配置、指标呈现进行进一步设计开发和功能配置实现。\r\n\t\t\t</span>\r\n\t\t\t<div class=\"logoAngle\"></div>\r\n      </div>\r\n\t</div>\r\n</template>\r\n  \r\n<script>\r\nimport { CirclePlus, Remove } from \"@element-plus/icons-vue\";\r\nimport { parameter } from \"../../api/apis.js\";\r\nexport default {\r\n\tcomponents: {\r\n\t\tCirclePlus,\r\n\t\tRemove,\r\n\t},\r\n\tdata() {\r\n\t\tconst dataSource = [];\r\n\t\treturn {\r\n\t\t\tdata: JSON.parse(JSON.stringify(dataSource)),\r\n\t\t\tdialog_show:true,\r\n\t\t\ttable_show: false,\r\n\t\t\tdialog_Visible: false,\r\n\t\t\ttitle: \"\",\r\n\t\t\tArrays: \"\",\r\n\t\t\tscene_id: \"\",\r\n\t\t\tname: \"\",\r\n\t\t\tdataSource: [],\r\n\t\t\tcolumnPropIndex: 0, //列属性自增\r\n\t\t\tcolumnLabel: \"新列\",\r\n\t\t\tmonitorFactor: [],\r\n\t\t\tcolumnData: [],\r\n\t\t\tNODE_KEY: \"id\", // id对应字段,\r\n\t\t\ttree_structure: [],\r\n\t\t\tdefaultProps: {\r\n\t\t\t\tchildren: \"children\",\r\n\t\t\t\tlabel: \"label\",\r\n\t\t\t},\r\n\t\t\tactiveName: 'second',\r\n\t\t\tHide: false,\r\n\t\t\tdisabled: true,\r\n\t\t\tserial: \"1\",//表格中序号\r\n\t\t\tid: \"\",//表格中ID\r\n\t\t\tsole_id: \"\",//表格中sole_id\r\n\t\t\tnum: \"1\",//表格中数量\r\n\t\t\ttableName: \"\",//表格名称\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmounted() {\r\n\t\t// 获取所有场景id\r\n\t\tparameter.Acquire().then((res) => {\r\n\t\t\tthis.Arrays = JSON.parse(res.data);\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\t// 打开弹框\r\n\t\topen(name, data, Scene) {\r\n\t\t\tthis.title = Scene\r\n\t\t\tthis.name = name\r\n\t\t\tthis.table_show = false\r\n\t\t\tif (name == '基站对象开发配置') {\r\n\t\t\t\tthis.dialog_Visible = true;\r\n\t\t\t\tthis.disabled = true\r\n\t\t\t\tthis.num = 1\r\n\t\t\t\tthis.data = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"宏基站\",\r\n\t\t\t\t\t\tname: \"宏基站\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"微基站\",\r\n\t\t\t\t\t\tname: \"微基站\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"PICO站\",\r\n\t\t\t\t\t\tname: \"PICO站\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t];\r\n\t\t\t\tdata.map((item, index) => {\r\n\t\t\t\t\tif (item.type == '宏基站') {\r\n\t\t\t\t\t\tthis.data[0].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '微基站') {\r\n\t\t\t\t\t\tthis.data[1].children.push(item)\r\n\t\t\t\t\t} else if (item.type == 'PICO站') {\r\n\t\t\t\t\t\tthis.data[2].children.push(item)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (name == '终端对象开发配置') {\r\n\t\t\t\tthis.dialog_Visible = true;\r\n\t\t\t\tthis.disabled = false\r\n\t\t\t\tthis.num = ''\r\n\t\t\t\tthis.data = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"移动手持终端\",\r\n\t\t\t\t\t\tname: \"移动手持终端\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"车载终端\",\r\n\t\t\t\t\t\tname: \"车载终端\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"摄像头\",\r\n\t\t\t\t\t\tname: \"摄像头\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"无人机\",\r\n\t\t\t\t\t\tname: \"无人机\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"视频下载类终端\",\r\n\t\t\t\t\t\tname: \"视频下载类终端\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"智能电表\",\r\n\t\t\t\t\t\tname: \"智能电表\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"机器人\",\r\n\t\t\t\t\t\tname: \"机器人\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"差动控制保护终端\",\r\n\t\t\t\t\t\tname: \"差动控制保护终端\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlabel: \"传感器\",\r\n\t\t\t\t\t\tname: \"传感器\",\r\n\t\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\ttype: 'Entries',\r\n\t\t\t\t\t},\r\n\t\t\t\t];\r\n\t\t\t\tdata.map((item, index) => {\r\n\t\t\t\t\tif (item.type == '移动手持终端') {\r\n\t\t\t\t\t\tthis.data[0].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '车载终端') {\r\n\t\t\t\t\t\tthis.data[1].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '摄像头') {\r\n\t\t\t\t\t\tthis.data[2].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '无人机') {\r\n\t\t\t\t\t\tthis.data[3].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '视频下载类终端') {\r\n\t\t\t\t\t\tthis.data[4].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '智能电表') {\r\n\t\t\t\t\t\tthis.data[5].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '机器人') {\r\n\t\t\t\t\t\tthis.data[6].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '差动控制保护终端') {\r\n\t\t\t\t\t\tthis.data[7].children.push(item)\r\n\t\t\t\t\t} else if (item.type == '传感器') {\r\n\t\t\t\t\t\tthis.data[8].children.push(item)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.Arrays.map((item, index) => {\r\n\t\t\t\tif (item.name == Scene) {\r\n\t\t\t\t\tthis.scene_id = item.scene_id;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//logo点击事件\r\n\t\tlogo(){\r\n\t\t\tthis.dialog_show = !this.dialog_show;\r\n\t\t},\r\n\t\t// 点击修改\r\n\t\thandleInput(_node, _data) {\r\n\t\t\t// 修改节点\r\n\t\t\tlet datalist = new FormData();\r\n\t\t\tdatalist.append(\"name\", _data.name);\r\n\t\t\tdatalist.append(\"id\", _data.id);\r\n\t\t\t//基站添加\r\n\t\t\tparameter.element_save(datalist).then((res) => {\r\n\t\t\t\tthis.$parent.element_back('基站库')\r\n\t\t\t\tthis.$parent.element_back('终端库')\r\n\t\t\t});\r\n\t\t\t// 退出编辑状态\r\n\t\t\tif (_node.isEdit) {\r\n\t\t\t\t_node[\"isEdit\"] = false;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//修改\r\n\t\thandleEdit(_node, _data) {\r\n\t\t\t// 设置编辑状态\r\n\t\t\tif (!_node.isEdit) {\r\n\t\t\t\t_node[\"isEdit\"] = true;\r\n\t\t\t}\r\n\t\t\t// 输入框聚焦\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tif (this.$refs[\"slotTreeInput\" + _data[this.NODE_KEY]]) {\r\n\t\t\t\t\tthis.$refs[\r\n\t\t\t\t\t\t\"slotTreeInput\" + _data[this.NODE_KEY]\r\n\t\t\t\t\t].$refs.input.focus();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//添加节点\r\n\t\tappend(data) {\r\n\t\t\tlet datalist = new FormData();\r\n\t\t\tdatalist.append(\"name\", 'new');\r\n\t\t\tdatalist.append(\"scene_id\", this.scene_id);\r\n\t\t\tdatalist.append(\"parent_id\", data.id);\r\n\t\t\tdatalist.append(\"type\", '');\r\n\t\t\tdatalist.append(\"lon\", '0');\r\n\t\t\tdatalist.append(\"lat\", '0');\r\n\t\t\tdatalist.append(\"element_type\", '');\r\n\t\t\tparameter.element_save(datalist).then((res) => {\r\n\t\t\t\tdata.children.push(JSON.parse(res.element));\r\n\t\t\t\tthis.$parent.structure_back()\r\n\t\t\t});\r\n\t\t},\r\n\t\t//删除节点\r\n\t\tremove(node, data) {\r\n\t\t\tthis.table_show = false\r\n\t\t\tconst parent = node.parent;\r\n\t\t\tconst children = parent.data.children || parent.data;\r\n\t\t\tconst index = children.findIndex(d => d.id === data.id);\r\n\t\t\tchildren.splice(index, 1);\r\n\t\t\tif (this.name == '基站对象开发配置') {\r\n\t\t\t\t// 基站删除接口\r\n\t\t\t\tlet dataobj = new FormData();\r\n\t\t\t\tdataobj.append(\"id\", data.id);\r\n\t\t\t\tdataobj.append(\"scene_id\", this.scene_id);\r\n\t\t\t\tparameter.element_delete(dataobj).then((res) => {\r\n\t\t\t\t\tthis.$parent.element_back('基站库')\r\n\t\t\t\t\tthis.$parent.structure_back()\r\n\r\n\t\t\t\t});\r\n\t\t\t} else if (this.name == '终端对象开发配置') {\r\n\t\t\t\t// 终端删除\r\n\t\t\t\tlet datalist = new FormData();\r\n\t\t\t\tdatalist.append(\"id\", data.id);\r\n\t\t\t\tdatalist.append(\"scene_id\", this.scene_id);\r\n\t\t\t\tparameter.element_delete(datalist).then((res) => {\r\n\t\t\t\t\tthis.$parent.element_back('终端库')\r\n\t\t\t\t\tthis.$parent.structure_back()\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//点击树结构元素\r\n\t\tCheckTitle(data, nodes) {\r\n\t\t\tthis.table_show = true\r\n\t\t\tthis.id = data.id\r\n\t\t\tthis.sole_id = data.id\r\n\t\t\tthis.tableName = data.label\r\n\t\t\tthis.serial = '1'\r\n\t\t\tif (data.id == undefined) {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tlet list = [data];\r\n\t\t\t\t//checkList是树结构数据\r\n\t\t\t\tthis.tree_structure = list;\r\n\r\n\t\t\t\t// 选择列表时进行回显表头\r\n\t\t\t\tlet datalist = new FormData();\r\n\t\t\t\tdatalist.append(\"id\", this.sole_id);\r\n\t\t\t\tparameter.element_header_select(datalist).then((res) => {\r\n\t\t\t\t\tthis.columnData = []\r\n\t\t\t\t\tlet header = res.data\r\n\t\t\t\t\tif (header == '[]') {\r\n\t\t\t\t\t\tif (data.type != '宏基站' && data.type != '微基站' && data.type != 'PICO站' && data.parent_id == '') {\r\n\t\t\t\t\t\t\tthis.columnData = [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tlabel: \"序号\",\r\n\t\t\t\t\t\t\t\t\tprop: \"0\",\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tlabel: \"数量\",\r\n\t\t\t\t\t\t\t\t\tprop: \"1\",\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.columnData = [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tlabel: \"序号\",\r\n\t\t\t\t\t\t\t\t\tprop: \"0\",\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\theader = JSON.parse(JSON.parse(res.data))\r\n\t\t\t\t\t\theader.map((item, index) => {\r\n\t\t\t\t\t\t\tthis.columnData.push(\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tlabel: item,\r\n\t\t\t\t\t\t\t\t\tprop: index,\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//选择列表时进行回显表值\r\n\t\t\t\tlet dataobj = new FormData();\r\n\t\t\t\tdataobj.append(\"id\", this.sole_id);\r\n\t\t\t\tparameter.element_param_select(dataobj).then((res) => {\r\n\t\t\t\t\tthis.dataSource = []\r\n\t\t\t\t\tlet arr = res.data\r\n\t\t\t\t\tif (arr == '[]') {\r\n\t\t\t\t\t\tif (data.type != '宏基站' && data.type != '微基站' && data.type != 'PICO站' && data.parent_id == '') {\r\n\t\t\t\t\t\t\tthis.dataSource = [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t0: 1,\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.dataSource = [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t0: 1,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tarr = JSON.parse(res.data)\r\n\t\t\t\t\t\tarr.map((item, index) => {\r\n\t\t\t\t\t\t\tlet obj = {}\r\n\t\t\t\t\t\t\titem.map((e, i) => {\r\n\t\t\t\t\t\t\t\tobj[i] = e\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.dataSource.push(obj)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (data.type != '') {\r\n\t\t\t\t\tthis.Hide = false\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.Hide = true\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//增加行\r\n\t\tAddRow() {\r\n\t\t\tconst circle = this.dataSource[this.dataSource.length - 1]; //取出数组中第一个对象\r\n\t\t\tthis.serial  =  circle['0']\r\n\t\t\tif (circle) {\r\n\t\t\t\tconst newObj = {};\r\n\t\t\t\tthis.serial++\r\n\t\t\t\tfor (let key in circle) {\r\n\t\t\t\t\t//把第一个对象的属性都赋值给新对象newObj  然后每个属性的值都设置为空；\r\n\t\t\t\t\tnewObj[key] = \"\";\r\n\t\t\t\t\tnewObj['0'] = this.serial;\r\n\t\t\t\t}\r\n\t\t\t\tthis.dataSource.push(newObj);\r\n\t\t\t}\r\n\t\t},\r\n\t\t//删除行\r\n\t\tRemoveRow() {\r\n\t\t\tif (this.dataSource.length > 1) {\r\n\t\t\t\tthis.dataSource.pop();\r\n\t\t\t} else {\r\n\t\t\t\tthis.$message.error(\"基础行无法删除\");\r\n\t\t\t}\r\n\t\t},\r\n\t\t//增加列\r\n\t\taddColumn() {\r\n\t\t\t// 1、//列标题数组中 增加一个标题\r\n\t\t\tconst columnObj = {};\r\n\t\t\tvar propStr = \"newline\"; //自定义一个列属性；\r\n\t\t\tcolumnObj.prop = propStr + this.columnPropIndex; //拼接自增数\r\n\t\t\tcolumnObj.label = this.columnLabel;\r\n\t\t\tthis.columnData.push(columnObj);\r\n\t\t\tthis.columnPropIndex++; //自增数每次加一\r\n\r\n\t\t\t//2、数据包中每个对象增加一个生成的新属性\r\n\t\t\tthis.dataSource.forEach((item, index) => {\r\n\t\t\t\t//遍历数据包\r\n\t\t\t\t//每个对象新加一个属性 每一行数据值默认给''\r\n\t\t\t\tif (index < this.dataSource.length - 1) {\r\n\t\t\t\t\titem[columnObj.prop] = \"\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//最后一个给null  才会是删除列的按钮 不然是输入框\r\n\t\t\t\t\titem[columnObj.prop] = \"\";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 删除列表\r\n\t\tRemoveColumn() {\r\n\t\t\tif (this.columnData.length > 1) {\r\n\t\t\t\tthis.columnData.pop();\r\n\t\t\t} else {\r\n\t\t\t\tthis.$message.error(\"基础列无法删除\");\r\n\t\t\t}\r\n\t\t},\r\n\t\t//修改表头\r\n\t\tonBlur(val, index) {\r\n\t\t\tthis.columnData.forEach((item, i) => {\r\n\t\t\t\tif (index === i) {\r\n\t\t\t\t\titem.label = val;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t//修改表头\r\n\t\trenderHeader({ column, $index }) {\r\n\t\t\treturn (\r\n\t\t\t\t<el-input\r\n\t\t\t\t\tv-model={column.label}\r\n\t\t\t\t\tblur={this.onBlur(column.label, $index)}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t},\r\n\t\t//提交数据\r\n\t\tsaveData() {\r\n\t\t\t//表头数据存储\r\n\t\t\tlet header = []\r\n\t\t\tthis.columnData.map((item, index) => {\r\n\t\t\t\theader.push(item.label)\r\n\t\t\t});\r\n\t\t\tlet datalist = new FormData();\r\n\t\t\tdatalist.append(\"id\", this.sole_id);\r\n\t\t\tdatalist.append(\"header\", JSON.stringify(header));\r\n\t\t\tparameter.element_header_save(datalist).then((res) => {\r\n\t\t\t});\r\n\r\n\t\t\t//表值数据存储\r\n\t\t\tlet data = []\r\n\t\t\tthis.dataSource.map((item, index) => {\r\n\t\t\t\tlet arr = []\r\n\t\t\t\tfor (let key in item) {\r\n\t\t\t\t\t//for循环let key是对象里面的键\r\n\t\t\t\t\tarr.push(item[key])\r\n\t\t\t\t}\r\n\t\t\t\tdata.push(arr)\r\n\t\t\t});\r\n\t\t\tlet dataobj = new FormData();\r\n\t\t\tdataobj.append(\"id\", this.sole_id);\r\n\t\t\tdataobj.append(\"data\", JSON.stringify(data));\r\n\t\t\tparameter.element_param_save(dataobj).then((res) => {\r\n\t\t\t});\r\n\t\t},\r\n\t}\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@import \"./css/equipment.scss\";\r\n</style>"]}]}